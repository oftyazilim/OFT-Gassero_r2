import{C as R}from"./vue3-perfect-scrollbar-BT2Ou4oR.js";import{_ as E}from"./AppTextField.vue_vue_type_script_setup_true_lang-B67lS2wl.js";import{_ as Y}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-UxdDcTYf.js";import{d as F,r as p,b2 as w,o as r,g as d,f as a,b as e,a$ as j,ai as U,t as v,e as u,k as q,c as C,n as o,V as h,v as y,F as P,i as G,b3 as K,q as W,y as H,aW as J}from"./main-CXefX_qh.js";import{a as O}from"./axios-CCb-kr4I.js";import{V as Q}from"./VCard-pJfFDOSH.js";import{V as A}from"./VCardText-BW9gFSa-.js";import{V as X}from"./VForm-CD_GLPlO.js";import{V as I}from"./VRow-qTTVFZ4i.js";import{V as g}from"./VCol-Dzvr-cnK.js";import{V as Z}from"./VDialog-Cm1FNAkS.js";import{u as ee}from"./useAbility-D1qkTrSg.js";import{V as M}from"./VAvatar-a73hCTk3.js";import{V as T}from"./VImg-Db788kHt.js";import{V as ae}from"./VMenu-DAf6uba2.js";import{V as te,a as $,d as oe,b as le}from"./VList-5j6JHPeN.js";import{V as se}from"./VListItemAction-zWjsJnCh.js";import{V as B}from"./VBadge-CrQldzvd.js";import{V as re}from"./VDivider-B8BIZrEP.js";const ie=u("h4",{class:"text-h4 text-center mb-2"}," Şifre Değiştir ",-1),ne=F({__name:"ChangePasswordModal",props:{isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible"],setup(L,{emit:k}){const c=p(!1),t=p(!1),i=p(!1),m=p(""),V=p(""),_=p(""),z=w("userData"),b=k,s=L,N=async()=>{try{console.log(m.value),await O.post("/api/change-password",{userId:z.value.id,current_password:m.value,new_password:V.value,new_password_confirmation:_.value}),alert("Şifreniz başarıyla değiştirildi."),b("update:isDialogVisible",!1)}catch(f){console.error("Şifre değiştirilirken hata oluştu:",f.response.data),alert(f.response.data.error||"Bir hata oluştu.")}},x=f=>{b("update:isDialogVisible",f)};return(f,l)=>{const S=Y,D=E;return r(),d(Z,{width:f.$vuetify.display.smAndDown?"auto":700,"model-value":s.isDialogVisible,"onUpdate:modelValue":x},{default:a(()=>[e(S,{onClick:l[0]||(l[0]=n=>x(!1))}),e(Q,{class:"pa-sm-10 pa-2"},{default:a(()=>[e(A,null,{default:a(()=>[ie,e(X,{class:"mt-6",onSubmit:j(N,["prevent"])},{default:a(()=>[e(I,null,{default:a(()=>[e(A,{class:"pt-0"},{default:a(()=>[e(I,null,{default:a(()=>[e(g,{cols:"12",md:"6"},{default:a(()=>[e(D,{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=n=>m.value=n),type:c.value?"text":"password","append-inner-icon":c.value?"tabler-eye-off":"tabler-eye",label:"Mevcut Şifre",autocomplete:"on",placeholder:"············","onClick:appendInner":l[2]||(l[2]=n=>c.value=!c.value)},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),e(I,null,{default:a(()=>[e(g,{cols:"12",md:"6"},{default:a(()=>[e(D,{modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=n=>V.value=n),type:t.value?"text":"password","append-inner-icon":t.value?"tabler-eye-off":"tabler-eye",label:"Yeni Şifre",autocomplete:"on",placeholder:"············","onClick:appendInner":l[4]||(l[4]=n=>t.value=!t.value)},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(g,{cols:"12",md:"6"},{default:a(()=>[e(D,{modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=n=>_.value=n),type:i.value?"text":"password","append-inner-icon":i.value?"tabler-eye-off":"tabler-eye",label:"Yeni Şifre (Tekrar)",autocomplete:"on",placeholder:"············","onClick:appendInner":l[6]||(l[6]=n=>i.value=!i.value)},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(U,{type:"submit"},{default:a(()=>[v(" Kaydet ")]),_:1}),e(U,{color:"secondary",variant:"tonal",onClick:l[7]||(l[7]=n=>x(!1))},{default:a(()=>[v(" Vazgeç ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),ue={class:"d-flex gap-2 align-center"},de={class:"text-h6 font-weight-medium"},pe={class:"px-2 py-2"},ce={class:"px-4 py-2"},me={class:"ms-4"},fe={style:{"margin-block-start":"18px"}},ve={style:{"margin-block-start":"-15px"}},Me=F({__name:"UserProfile",setup(L){const k=q(),c=ee(),t=w("userData");p(null);const i=p(!1),m=()=>{i.value=!i.value},V=async()=>{w("accessToken").value=null,t.value=null,await k.push("/login"),w("userAbilityRules").value=null,c.update([])},_=[{type:"divider"}];return(z,b)=>(r(),C(P,null,[o(t)?(r(),d(B,{key:0,dot:"",bordered:"",location:"bottom right","offset-x":"-142","offset-y":"-14",color:"success"},{default:a(()=>[e(M,{size:"38",class:"cursor-pointer mt-3",color:o(t)&&o(t).avatar?void 0:"primary",variant:o(t)&&o(t).avatar?void 0:"tonal"},{default:a(()=>[o(t)&&o(t).avatar?(r(),d(T,{key:0,src:o(t).avatar},null,8,["src"])):(r(),d(h,{key:1,icon:"tabler-user"})),e(ae,{activator:"parent",width:"240",location:"bottom end",offset:"12px"},{default:a(()=>[e(te,null,{default:a(()=>[e($,null,{default:a(()=>[u("div",ue,[e(se,null,{default:a(()=>[e(B,{dot:"",location:"bottom right","offset-x":"3","offset-y":"3",color:"success",bordered:""},{default:a(()=>[e(M,{color:o(t)&&o(t).avatar?void 0:"primary",variant:o(t)&&o(t).avatar?void 0:"tonal"},{default:a(()=>[o(t)&&o(t).avatar?(r(),d(T,{key:0,src:o(t).avatar},null,8,["src"])):(r(),d(h,{key:1,icon:"tabler-user"}))]),_:1},8,["color","variant"])]),_:1})]),_:1}),u("div",null,[u("h6",de,y(o(t).name||o(t).email),1),e(oe,{class:"text-capitalize text-disabled"},{default:a(()=>[v(y(o(t).unvan),1)]),_:1})])])]),_:1}),e(o(R),{options:{wheelPropagation:!1}},{default:a(()=>[(r(),C(P,null,G(_,s=>(r(),C(P,{key:s.title},[s.type==="navItem"?(r(),d($,{key:0,to:s.to},K({prepend:a(()=>[e(h,{icon:s.icon,size:"22"},null,8,["icon"])]),default:a(()=>[e(le,null,{default:a(()=>[v(y(s.title),1)]),_:2},1024)]),_:2},[s.badgeProps?{name:"append",fn:a(()=>[e(B,W({rounded:"sm",class:"me-3",ref_for:!0},s.badgeProps),null,16)]),key:"0"}:void 0]),1032,["to"])):(r(),d(re,{key:1,class:"my-2"})),u("div",pe,[e($,{onClick:m},{default:a(()=>[v("Şifre Değiştir")]),_:1})])],64))),64)),u("div",ce,[e(U,{block:"",size:"small",color:"error","append-icon":"tabler-logout",onClick:V},{default:a(()=>[v(" Güvenli Çıkış ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["color","variant"]),u("div",me,[u("p",fe,y(o(t).name),1),u("p",ve,y(o(t).unvan),1)])]),_:1})):H("",!0),e(ne,{isDialogVisible:o(i),"onUpdate:isDialogVisible":b[0]||(b[0]=s=>J(i)?i.value=s:null)},null,8,["isDialogVisible"])],64))}});export{Me as _};
