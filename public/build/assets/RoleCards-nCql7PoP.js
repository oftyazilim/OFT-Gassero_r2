import{_ as W}from"./AppTextField.vue_vue_type_script_setup_true_lang-B67lS2wl.js";import{_ as L}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-UxdDcTYf.js";import{V as S}from"./VCard-pJfFDOSH.js";import{V as B}from"./VCardText-BW9gFSa-.js";import{V as X}from"./VForm-CD_GLPlO.js";import{V as q}from"./VTable-B3TJP9Kw.js";import{V as w}from"./VCheckbox-j2Nzq_3x.js";import{d as Q,r as p,$ as T,w as j,o as m,g as $,f as t,b as s,e as a,v as D,n as V,aW as z,c as k,F as U,i as F,ai as I,t as R,E as H,y as K,V as J,a as O,P as Z,Q as ee}from"./main-CXefX_qh.js";import{V as le}from"./VDialog-Cm1FNAkS.js";import{a as N}from"./avatar-1-mrBiEG2D.js";import{a as Y}from"./avatar-2-J3iDMrW6.js";import{a as G}from"./axios-CCb-kr4I.js";import{V as ae}from"./VSpacer-OtyVf5vj.js";import{V as A}from"./VAvatar-a73hCTk3.js";import{V as P}from"./VCol-Dzvr-cnK.js";import{V as M}from"./VRow-qTTVFZ4i.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"text-h4 text-center mb-2"},oe=a("p",{class:"text-body-1 text-center mb-6"},"Rol izinlerini ayarla...",-1),ne=a("h5",{class:"text-h5 my-6"},"Rol İzinleri",-1),ie=a("td",null,[a("h6",{class:"text-h6"},"Yönetici Erişimi")],-1),de={colspan:"3"},re={class:"d-flex justify-end"},ue={class:"text-h6"},ce={class:"d-flex justify-end"},me={class:"d-flex justify-end"},fe={class:"d-flex justify-end"},pe={class:"d-flex justify-end"},ve={class:"d-flex align-center justify-center gap-4"},_e=Q({__name:"AddEditRoleDialog",props:{rolePermissions:{default:()=>({name:"",permissions:[]})},isDialogVisible:{type:Boolean}},emits:["update:isDialogVisible","update:rolePermissions"],setup(b,{emit:v}){const C=b,r=v,u=p([{name:"Dashboards",view:!1,add:!1,edit:!1,delete:!1},{name:"YTK Dashboard",view:!1,add:!1,edit:!1,delete:!1},{name:"DTK Dashboard",view:!1,add:!1,edit:!1,delete:!1},{name:"ESD Dashboard",view:!1,add:!1,edit:!1,delete:!1},{name:"Ayarlar",view:!1,add:!1,edit:!1,delete:!1},{name:"Kullanıcılar",view:!1,add:!1,edit:!1,delete:!1},{name:"Roller",view:!1,add:!1,edit:!1,delete:!1},{name:"İzinler",view:!1,add:!1,edit:!1,delete:!1}]),d=p(""),f=p(!1),g=p(),E=T(()=>u.value.reduce((e,l)=>e+ +l.read+ +l.write+ +l.create,0)),i=T(()=>E.value>0&&E.value<u.value.length*3);j(f,e=>{u.value.forEach(l=>{l.view=e,l.add=e,l.edit=e,l.delete=e})}),j(()=>C.rolePermissions,e=>{e&&(d.value=e.name,u.value=u.value.map(l=>{const c=e.permissions.find(x=>x.name===l.name);return c?{...l,...c}:{...l,view:!1,add:!1,edit:!1,delete:!1}}))},{immediate:!0});const n=()=>{var l;const e={name:d.value,permissions:u.value};r("update:rolePermissions",e),r("update:isDialogVisible",!1),f.value=!1,(l=g.value)==null||l.reset()},_=()=>{var e;r("update:isDialogVisible",!1),f.value=!1,(e=g.value)==null||e.reset()},y=async e=>{try{const{data:l}=await axios.get(`/api/permissions?role=${e}`);u.value=u.value.map(c=>{const x=l.find(o=>o.name===c.name);return x?{...c,...x}:{...c,view:!1,add:!1,edit:!1,delete:!1}})}catch(l){console.error("İzinler alınırken hata oluştu:",l.message||l)}};return j(()=>C.rolePermissions,e=>{e!=null&&e.name&&(d.value=e.name,y(e.name))},{immediate:!0}),(e,l)=>{const c=L,x=W;return m(),$(le,{width:e.$vuetify.display.smAndDown?"auto":900,"model-value":C.isDialogVisible,"onUpdate:modelValue":_},{default:t(()=>[s(c,{onClick:_}),s(S,{class:"pa-sm-10 pa-2"},{default:t(()=>[s(B,null,{default:t(()=>[a("h4",te,D(V(d)?"Rol Düzenle":"Yeni Rol Ekle"),1),oe,s(V(X),{ref_key:"refPermissionForm",ref:g},{default:t(()=>[s(x,{modelValue:V(d),"onUpdate:modelValue":l[0]||(l[0]=o=>z(d)?d.value=o:null),label:"Rol Adı"},null,8,["modelValue"]),ne,s(q,{class:"permission-table text-no-wrap mb-6"},{default:t(()=>[a("tr",null,[ie,a("td",de,[a("div",re,[s(w,{modelValue:V(f),"onUpdate:modelValue":l[1]||(l[1]=o=>z(f)?f.value=o:null),indeterminate:V(i),"onUpdate:indeterminate":l[2]||(l[2]=o=>z(i)?i.value=o:null),label:"Tümünü Seç"},null,8,["modelValue","indeterminate"])])])]),(m(!0),k(U,null,F(V(u),o=>(m(),k("tr",{key:o.name},[a("td",null,[a("h6",ue,D(o.name),1)]),a("td",null,[a("div",ce,[s(w,{modelValue:o.view,"onUpdate:modelValue":h=>o.view=h,label:"Görüntüle"},null,8,["modelValue","onUpdate:modelValue"])])]),a("td",null,[a("div",me,[s(w,{modelValue:o.add,"onUpdate:modelValue":h=>o.add=h,label:"Ekle"},null,8,["modelValue","onUpdate:modelValue"])])]),a("td",null,[a("div",fe,[s(w,{modelValue:o.edit,"onUpdate:modelValue":h=>o.edit=h,label:"Düzenle"},null,8,["modelValue","onUpdate:modelValue"])])]),a("td",null,[a("div",pe,[s(w,{modelValue:o.delete,"onUpdate:modelValue":h=>o.delete=h,label:"Sil"},null,8,["modelValue","onUpdate:modelValue"])])])]))),128))]),_:1}),a("div",ve,[s(I,{onClick:n},{default:t(()=>[R(D(V(d)?"Güncelle":"Kaydet"),1)]),_:1}),s(I,{color:"secondary",variant:"tonal",onClick:_},{default:t(()=>[R(" İptal ")]),_:1})])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),Ve="/build/assets/girl-using-mobile-CKXBkoEQ.png",ge=b=>(Z("data-v-144576e4"),b=b(),ee(),b),he={class:"text-body-1"},be={class:"v-avatar-group",style:{display:"flex","align-items":"center"}},ye={class:"d-flex justify-space-between align-center"},xe={class:"text-h5"},ke={class:"d-flex align-center"},De=["onClick"],Ce=["src"],we=ge(()=>a("div",{class:"text-end"},[R(" Add new role,"),a("br"),R(" if it doesn't exist. ")],-1)),$e=Q({__name:"RoleCards",setup(b){const v=p([]),C=async()=>{try{const{data:i}=await G.get("/api/roles-with-user-count");console.log("api:",r.value),r.value=r.value.map(n=>{const _=i.find(e=>e.role_id===n.id),y=_?_.user_count:0;return n.userCount=y,n}),console.log("Güncellenmiş roller:",r.value)}catch(i){console.error("Roller alınırken bir hata oluştu:",i.message||i)}},r=p([]),u=async()=>{try{const i=await G.get("/api/roles");r.value=i.data.map(n=>({role:n,users:[N,Y],details:{name:n,permissions:[]}})),console.log("Roller işlendi:",r.value)}catch(i){console.error("Veri alınırken bir hata oluştu:",i)}};H(()=>{u(),C(),v.value=[N,Y]});const d=p(!1),f=p(null),g=p(!1),E=i=>{d.value=!0,f.value=i};return(i,n)=>{const _=O("IconBtn"),y=_e;return m(),k(U,null,[s(M,null,{default:t(()=>[(m(!0),k(U,null,F(r.value,e=>(m(),$(P,{key:e.role,cols:"12",sm:"6",lg:"4"},{default:t(()=>[s(S,null,{default:t(()=>[s(B,{class:"d-flex align-center pb-4"},{default:t(()=>[a("div",he," Total "+D(e.userCount)+" users ",1),s(ae),a("div",be,[(m(!0),k(U,null,F(v.value,(l,c)=>(m(),k(U,{key:c},[v.value.length>4&&c<3?(m(),$(A,{key:0,size:"40",image:l},null,8,["image"])):v.value.length<=4?(m(),$(A,{key:1,size:"40",image:l},null,8,["image"])):K("",!0)],64))),128)),v.value.length>4?(m(),$(A,{key:0,size:"40",color:i.$vuetify.theme.current.dark?"#373B50":"#EEEDF0",class:"extra-avatar"},{default:t(()=>[a("span",null,"+"+D(v.value.length-3),1)]),_:1},8,["color"])):K("",!0)])]),_:2},1024),s(B,null,{default:t(()=>[a("div",ye,[a("div",null,[a("h5",xe,D(e.role),1),a("div",ke,[a("a",{href:"javascript:void(0)",onClick:l=>E(e.details)}," Edit Role ",8,De)])]),s(_,null,{default:t(()=>[s(J,{icon:"tabler-copy",class:"text-high-emphasis"})]),_:1})])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),s(P,{cols:"12",sm:"6",lg:"4"},{default:t(()=>[s(S,{class:"h-100",ripple:!1},{default:t(()=>[s(M,{"no-gutters":"",class:"h-100"},{default:t(()=>[s(P,{cols:"5",class:"d-flex flex-column justify-end align-center mt-5"},{default:t(()=>[a("img",{width:"85",src:V(Ve)},null,8,Ce)]),_:1}),s(P,{cols:"7"},{default:t(()=>[s(B,{class:"d-flex flex-column align-end justify-end gap-4"},{default:t(()=>[s(I,{size:"small",onClick:n[0]||(n[0]=e=>g.value=!0)},{default:t(()=>[R(" Yeni Rol Ekle ")]),_:1}),we]),_:1})]),_:1})]),_:1})]),_:1}),s(y,{"is-dialog-visible":g.value,"onUpdate:isDialogVisible":n[1]||(n[1]=e=>g.value=e)},null,8,["is-dialog-visible"])]),_:1})]),_:1}),s(y,{"is-dialog-visible":d.value,"onUpdate:isDialogVisible":n[2]||(n[2]=e=>d.value=e),"role-permissions":f.value,"onUpdate:rolePermissions":n[3]||(n[3]=e=>f.value=e)},null,8,["is-dialog-visible","role-permissions"])],64)}}}),Qe=se($e,[["__scopeId","data-v-144576e4"]]);export{Qe as R};
