import{a as o}from"./axios-CCb-kr4I.js";import x from"./CardIstasyon-B98gLLES.js";import g from"./CardGenelDurum-BQ4othvj.js";import{u as z}from"./pageTitle-DZX-JdGE.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as T,a as _}from"./VRow-Z9fbV_da.js";import{c,b as h,f as p,e as k,v as b,F as f,a as y,o as m,i as I,g as A}from"./main-C8N3ebfR.js";import"./VCard-BdrtuRPD.js";import"./VAvatar-DY8J7Y8l.js";import"./VImg-BEBs2K_P.js";import"./VCardText-ARgIvpol.js";import"./VContainer-CNJClx8r.js";/* empty css              */const G=z();document.title="OFT - YTK Dashboard";const P={components:{CardIstasyon:x,CardGenelDurum:g},data(){return{cards:[{title:"BORU",plan:0,uretilen:{h:0,g:0},uretim:0,kalan:0,yuzde:0,ilerleme:0},{title:"POMPA",plan:0,uretilen:{h:0,g:0},uretim:0,kalan:0,yuzde:0,ilerleme:0},{title:"ŞASE",plan:0,uretilen:{h:0,g:0},uretim:0,kalan:0,yuzde:0,ilerleme:0},{title:"SİFON",plan:0,uretilen:{h:0,g:0},uretim:0,kalan:0,yuzde:0,ilerleme:0},{title:"VENTURİ",plan:0,uretilen:{h:0,g:0},uretim:0,kalan:0,yuzde:0,ilerleme:0},{title:"GALVANİZ",plan:0,uretilen:{h:0,g:0},uretim:0,kalan:0,yuzde:0,ilerleme:0}],intervalId:null,baslik:"...",durumYuzde:0,uretilenGorunur:!0,index:0,texts:["0","..."],textsBaslik:["(gunluk)","(haftalık)"],textsMiktar1:["0","0"],textsMiktar2:["0","0"],textsMiktar3:["0","0"],textsMiktar4:["0","0"],textsMiktar5:["0","0"],textsMiktar6:["0","0"],sureler:["0","0"],miktarTexts:{"BG-1":["0","0"],"PG-1":["0","0"],"ŞG-1":["0","0"],"SG-1":["0","0"],"VG-1":["0","0"],"GG-1":["0","0"]},currentTextIndex:0,genelPlan:0,genelUretim:0,hedefGenel:0,oran:0,durumYuzde:"0",altMesaj:"...",formatliTarihSaat:"...",yuzdelik:0}},computed:{currentText(){return this.texts[this.currentTextIndex]}},mounted(){G.setTitle("YTK Dashboard"),G.setToplam(" "),this.zamanAl(),this.mesajAl(),this.updateMiktar(),this.updateTextsPeriodically()},unmounted(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),console.log("Dashboard bileşeni yok edildi ve tüm zamanlayıcılar temizlendi.")},methods:{async zamanAl(){try{const r=await o.get("/api/dashboards/zamanal_ytk");if(r.data.KAYITTARIH){const e=new Date(r.data.KAYITTARIH);this.formatliTarihSaat=`${e.getDate()}.${e.getMonth()+1}.${e.getFullYear()} - ${e.getHours()}:${e.getMinutes()}`}}catch{this.formatliTarihSaat="..."}},async mesajAl(){try{const r=await o.get("/api/dashboards/mesajal");this.altMesaj=r.data.mesaj.DEGER||"Mesaj alınamadı"}catch(r){console.error("Mesaj çekme hatası:",r)}},async miktarAl(r){try{const t=(await o.get("/api/dashboards/miktaral_ytk",{params:{param1:r}})).data;let s=t.planHafta.toplam_planlanan||0,n=t.planHafta.toplam_uretim||0,u=t.urtGun.toplam_uretim||0,l=t.urtHafta.toplam_uretim||0;this.genelPlan+=parseInt(s),this.genelUretim+=parseInt(l);const d=s,a=s-n;let i=0;switch(l>0&&d>0&&(i=Math.round(l/d*100)),r){case"BG-1":this.cards[0].plan=s,this.cards[0].kalan=a,this.cards[0].yuzde=i,this.cards[0].ilerleme=i,this.cards[0].uretilen[0]=u,this.cards[0].uretilen[1]=l;break;case"PG-1":this.cards[1].plan=s,this.cards[1].kalan=a,this.cards[1].yuzde=i,this.cards[1].ilerleme=i,this.cards[1].uretilen[0]=u,this.cards[1].uretilen[1]=l;break;case"ŞG-1":this.cards[2].plan=s,this.cards[2].kalan=a,this.cards[2].yuzde=i,this.cards[2].ilerleme=i,this.cards[2].uretilen[0]=u,this.cards[2].uretilen[1]=l;break;case"SG-1":this.cards[3].plan=s,this.cards[3].kalan=a,this.cards[3].yuzde=i,this.cards[3].ilerleme=i,this.cards[3].uretilen[0]=u,this.cards[3].uretilen[1]=l;break;case"VG-1":this.cards[4].plan=s,this.cards[4].kalan=a,this.cards[4].yuzde=i,this.cards[4].ilerleme=i,this.cards[4].uretilen[0]=u,this.cards[4].uretilen[1]=l;break;case"GG-1":this.cards[5].plan=s,this.cards[5].kalan=a,this.cards[5].yuzde=i,this.cards[5].ilerleme=i,this.cards[5].uretilen[0]=u,this.cards[5].uretilen[1]=l;break}}catch(e){console.error("Plan çekme hatası:",e)}},async updateMiktar(){this.genelPlan=0,this.genelUretim=0,this.hedefGenel=0;const r=["BG-1","PG-1","ŞG-1","SG-1","VG-1","GG-1"];await Promise.all(r.map(s=>this.miktarAl(s))),this.hedefGenel=this.genelPlan;let e=0;this.genelPlan>0?e=Math.round(this.genelUretim/this.hedefGenel*100):e=0;let t="";e<=20?t="...":e>20&&e<=40?t="kötü":e>40&&e<=50?t="sıkıntılı":e>50&&e<=65?t="eh işte":e>65&&e<=80?t="iyi":e>80&&e<=90?t="çok iyi":e>90&&e<=99?t="harika":e>=99&&(t="süper"),this.yuzdelik=e,this.texts[0]="%"+e,this.texts[1]=t},updateTextsPeriodically(){this.intervalId=setInterval(()=>{this.zamanAl(),this.mesajAl(),this.updateMiktar(),this.uretilenGorunur=!1,setTimeout(()=>{this.index=(this.index+1)%this.texts.length,this.baslik=this.textsBaslik[this.index],this.cards[0].uretim=Math.floor(this.cards[0].uretilen[this.index]),this.cards[1].uretim=Math.floor(this.cards[1].uretilen[this.index]),this.cards[2].uretim=Math.floor(this.cards[2].uretilen[this.index]),this.cards[3].uretim=Math.floor(this.cards[3].uretilen[this.index]),this.cards[4].uretim=Math.floor(this.cards[4].uretilen[this.index]),this.cards[5].uretim=Math.floor(this.cards[5].uretilen[this.index]),this.durumYuzde=this.texts[0],this.uretilenGorunur=!0},1e3)},3e3)}}},S={style:{color:"orange",fontFamily:"Montserrat"}};function j(r,e,t,s,n,u){const l=y("CardIstasyon"),d=y("CardGenelDurum");return m(),c(f,null,[h(T,{"no-gutters":""},{default:p(()=>[(m(!0),c(f,null,I(n.cards,a=>(m(),A(_,{md:"4",lg:"",sm:"6",key:a.title},{default:p(()=>[h(l,{uretilenGorunur:n.uretilenGorunur,title:a.title,plan:a.plan,baslik:n.baslik,uretilen:a.uretim,kalan:a.kalan,yuzde:a.yuzde,ilerleme:a.ilerleme},null,8,["uretilenGorunur","title","plan","baslik","uretilen","kalan","yuzde","ilerleme"])]),_:2},1024))),128))]),_:1}),h(d,{class:"mt-5",uretilenGorunur:n.uretilenGorunur,durumYuzde:n.durumYuzde,altMesaj:n.altMesaj,yuzdelik:n.yuzdelik},null,8,["uretilenGorunur","durumYuzde","altMesaj","yuzdelik"]),k("div",null,[k("h3",S,"Son veri girişi: "+b(n.formatliTarihSaat),1)])],64)}const N=M(P,[["render",j]]);export{N as default};
